'use client';
import{__rest as e}from"tslib";import r,{useState as t,useMemo as o}from"react";import{border as a}from"../../../lib/shape.js";import{sizing as d}from"../../../lib/sizing.js";import{spacing as n}from"../../../lib/spacing.js";import{tremorTwMerge as l}from"../../../lib/tremorTwMerge.js";import{DayPicker as m}from"react-day-picker";import{startOfToday as s,startOfMonth as i}from"date-fns";import{enUS as u}from"date-fns/locale";import c from"../../../hooks/useInternalState.js";import{defaultOptions as b,parseStartDate as f,parseEndDate as k,formatSelectedDates as p,makeDateRangePickerClassName as g}from"./dateRangePickerUtils.js";import"../Select/Select.js";import h from"../Select/SelectItem.js";import v from"../../../assets/ArrowRightHeadIcon.js";import w from"../../../assets/ArrowLeftHeadIcon.js";import x from"../../../assets/XCircleIcon.js";import{Popover as y,Listbox as j}from"@headlessui/react";import{getNodeText as E,constructValueToNameMapping as N,getSelectButtonColors as _,hasValue as X}from"../selectUtils.js";const S=s(),R=r.forwardRef(((s,R)=>{var C,I;const{value:D,defaultValue:V,onValueChange:B,enableSelect:O=!0,minDate:P,maxDate:L,placeholder:M="Select",selectPlaceholder:z="Select",disabled:F=!1,locale:T=u,enableClear:A=!0,children:H,className:U}=s,Y=e(s,["value","defaultValue","onValueChange","enableSelect","minDate","maxDate","placeholder","selectPlaceholder","disabled","locale","enableClear","children","className"]),[q,G]=c(V,D),[J,K]=t(!1),[Q,W]=t(!1),Z=o((()=>{const e=[];return P&&e.push({before:P}),L&&e.push({after:L}),e}),[P,L]),$=o((()=>{const e=new Map;return H?r.Children.forEach(H,(r=>{var t;e.set(r.props.value,{text:null!==(t=E(r))&&void 0!==t?t:r.props.value,from:r.props.from,to:r.props.to})})):b.forEach((r=>{e.set(r.value,{text:r.text,from:r.from,to:S})})),e}),[H]),ee=o((()=>{if(H)return N(H);const e=new Map;return b.forEach((r=>e.set(r.value,r.text))),e}),[H]),re=null==q?void 0:q.selectValue,te=f(null==q?void 0:q.from,P,re,$),oe=k(null==q?void 0:q.to,L,re,$),ae=te||oe?p(te,oe,T):M,de=i(null!==(I=null!==(C=null!=oe?oe:te)&&void 0!==C?C:L)&&void 0!==I?I:S),ne=A&&!F;return r.createElement("div",Object.assign({ref:R,className:l("w-full min-w-[10rem] relative flex justify-between text-tremor-default","max-w-sm",U)},Y),r.createElement(y,{as:"div",className:l("w-full overflow-hidden",O?"rounded-l-tremor-default":"rounded-tremor-default",J&&"ring-2 ring-tremor-brand-muted dark:focus:ring-dark-tremor-brand-muted")},r.createElement("div",{className:"relative w-full overflow-hidden"},r.createElement(y.Button,{onFocus:()=>K(!0),onBlur:()=>K(!1),disabled:F,className:l("w-full outline-none text-left whitespace-nowrap truncate focus:ring-2 transition duration-100 rounded-l-tremor-default","rounded-l-tremor-default border-tremor-border shadow-tremor-input text-tremor-content-emphasis focus:border-tremor-brand-subtle","dark:border-dark-tremor-border dark:shadow-dark-tremor-input dark:text-dark-tremor-content-emphasis dark:focus:border-dark-tremor-brand-subtle",O?"rounded-l-tremor-default":"rounded-tremor-default",n.twoXl.paddingLeft,ne?n.fourXl.paddingRight:n.twoXl.paddingRight,n.sm.paddingY,a.sm.all,_(X(te||oe),F))},ae),ne&&r.createElement("button",{className:l("absolute outline-none focus:ring-2 inset-y-0 right-0 flex items-center transition duration-100","focus:border-tremor-brand-subtle focus:ring-tremor-brand-muted","dark:focus:border-dark-tremor-brand-subtle dark:focus:ring-dark-tremor-brand-muted",n.twoXl.marginRight),onClick:e=>{e.preventDefault(),null==B||B({}),G({})}},r.createElement(x,{className:l(g("clearIcon"),"flex-none","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle",d.md.height,d.md.width)}))),r.createElement(y.Panel,{className:l("absolute z-10 divide-y overflow-y-auto min-w-min left-0 outline-none rounded-tremor-default","bg-tremor-background border-tremor-border divide-tremor-border shadow-tremor-dropdown","dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border dark:shadow-dark-tremor-dropdown",n.twoXs.marginTop,n.twoXs.marginBottom,a.sm.all)},r.createElement(m,Object.assign({mode:"range",showOutsideDays:!0,defaultMonth:de,selected:{from:te,to:oe},onSelect:e=>{null==B||B({from:null==e?void 0:e.from,to:null==e?void 0:e.to}),G({from:null==e?void 0:e.from,to:null==e?void 0:e.to})},locale:T,disabled:Z,className:"p-3",classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-2 relative items-center",caption_label:"text-tremor-default text-tremor-content-emphasis dark:text-dark-tremor-content-emphasis font-medium",nav:"space-x-1 flex items-center",nav_button:l("flex items-center justify-center p-1 h-7 w-7 outline-none focus:ring-2 transition duration-100 border border-tremor-border dark:border-dark-tremor-border hover:bg-tremor-background-muted dark:hover:bg-dark-tremor-background-muted rounded-tremor-small focus:border-tremor-brand-subtle dark:focus:border-dark-tremor-brand-subtle focus:ring-tremor-brand-muted dark:focus:ring-dark-tremor-brand-muted text-tremor-content-subtle dark:text-dark-tremor-content-subtle hover:text-tremor-content dark:hover:text-dark-tremor-content"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"w-9 font-normal text-center text-tremor-content-subtle dark:text-dark-tremor-content-subtle",row:"flex w-full mt-0.5",cell:"text-center p-0 relative focus-within:relative text-tremor-default text-tremor-content-emphasis dark:text-dark-tremor-content-emphasis",day:"h-9 w-9 p-0 hover:bg-tremor-background-subtle dark:hover:bg-dark-tremor-background-subtle outline-tremor-brand dark:outline-dark-tremor-brand rounded-tremor-default",day_selected:"aria-selected:bg-tremor-background-emphasis aria-selected:text-tremor-content-inverted dark:aria-selected:bg-dark-tremor-background-emphasis dark:aria-selected:text-dark-tremor-content-inverted ",day_disabled:"text-tremor-content-subtle dark:text-dark-tremor-content-subtle disabled:hover:bg-transparent",day_range_middle:l("!rounded-none aria-selected:!bg-tremor-background-subtle aria-selected:dark:!bg-dark-tremor-background-subtle aria-selected:!text-tremor-content aria-selected:dark:!bg-dark-tremor-background-subtle"),day_outside:"text-tremor-content-subtle dark:text-dark-tremor-content-subtle",day_range_start:"rounded-r-none rounded-l-tremor-small aria-selected:text-tremor-brand-inverted dark:aria-selected:text-dark-tremor-brand-inverted",day_range_end:"rounded-l-none rounded-r-tremor-small aria-selected:text-tremor-brand-inverted dark:aria-selected:text-dark-tremor-brand-inverted"},components:{IconLeft:t=>{var o=e(t,[]);return r.createElement(w,Object.assign({className:"h-4 w-4"},o))},IconRight:t=>{var o=e(t,[]);return r.createElement(v,Object.assign({className:"h-4 w-4"},o))}}},s)))),O&&r.createElement(j,{as:"div",className:l("w-48 overflow-hidden -ml-px rounded-r-tremor-default",Q&&"ring-2 ring-tremor-brand-muted dark:focus:ring-dark-tremor-brand-muted"),value:re,onChange:e=>{const{from:r,to:t}=$.get(e),o=null!=t?t:S;null==B||B({from:r,to:o,selectValue:e}),G({from:r,to:o,selectValue:e})},disabled:F},(({value:e})=>{var t;return r.createElement(r.Fragment,null,r.createElement(j.Button,{onFocus:()=>W(!0),onBlur:()=>W(!1),className:l("w-full outline-none text-left whitespace-nowrap truncate rounded-r-tremor-default transition duration-100","border-tremor-border shadow-tremor-input text-tremor-content-emphasis focus:border-tremor-brand-subtle","dark:border-dark-tremor-border dark:shadow-dark-tremor-input dark:text-dark-tremor-content-emphasis dark:focus:border-dark-tremor-brand-subtle",n.twoXl.paddingLeft,n.twoXl.paddingRight,n.sm.paddingY,a.sm.all,_(X(e),F))},e&&null!==(t=ee.get(e))&&void 0!==t?t:z),r.createElement(j.Options,{className:l("absolute z-10 divide-y overflow-y-auto w-full inset-x-0 right-0 outline-none","shadow-tremor-dropdown bg-tremor-background border-tremor-border divide-tremor-border rounded-tremor-default","dark:shadow-dark-tremor-dropdown dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border",n.twoXs.marginTop,n.twoXs.marginBottom,a.sm.all)},null!=H?H:b.map((e=>r.createElement(h,{key:e.value,value:e.value},e.text)))))})))}));R.displayName="DateRangePicker";export{R as default};
